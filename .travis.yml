language: node_js
node_js: 4.5.0
cache:
  directories: node_modules
env:
  global:
  - HEIMDALL_VERSION_NUMBER=1.0.0
  - HEIMDALL_PACKAGE_NAME=heimdall-api-dev-$HEIMDALL_VERSION_NUMBER.$TRAVIS_BUILD_NUMBER-$TRAVIS_BRANCH.zip
install:
- npm install -g coveralls
- npm install -g strongloop
script:
- slc build --install
before_deploy:
- zip -rq $HEIMDALL_PACKAGE_NAME *
- mkdir -p dpl_cd_upload
- mv $HEIMDALL_PACKAGE_NAME dpl_cd_upload/$HEIMDALL_PACKAGE_NAME
deploy:
- provider: s3
  access_key_id: &1
    secure: ZxelcVzKROM9nY4NXOKwRZOVghQHXDpq2Qgo5y4dIzzru0YQ+7YLdx1CmxoFkybmQpnYGwPcWijH5ueKEx0c/FJ1jqbbqaEdQ+XPqNcsESORWqUlmFrXfgr3oTXGKflkkrfgtA9ME1RtW4tXOad5HLxEvk18hr70rD8MEMKGqwuGyIu8a17lxnAShYDGUC3u/Vz7oq9ahLLRyL+l4q1csga7vmZE8rEBwJ6GhJSiuHfNReMNYfLpj9OJqE58jt5TKBC3HSo4yw1mNOUJlVPNFyjWbwSQGztLElnu2D7sCD4XITptiA4OEugARwjkvf8GC3DFfQgqGcBYasWMSRYqPYmOZkrjbc6I2efGlw+HO2o4Qu6kPyAuEMQo3vd+Jl5MQH2xTyuuYM16hZTkHjYNKOlfszplfpslcKIc/4tZ7P4l1nZaIqH19Ib7R5q7xKLihxvW3RgZ/xj1dWj0Ju7jLz3spOVwZexSqgrQGQnTXV1e2SDdJfj0S8t0G0mIOf3SL6IAdtNr96UOq7DDpN+O/PpEoC9F6AZfxbaIASgSzp+wD3YFsgmH8TVJOxymcD8WFTtM3pBfXFiHl+F/yBVEknGCseASZ8BF4HpF7oqRKiJCqlLtb0A1JjttcL9EAeFTaPoNeUSKdmkaWDROm2iuU/9awAa/AqLOt/cRa5taeRs=
  secret_access_key: &2
    secure: ak+b30ubjqrwICgeTjrllPxQP6PGYOBDB2HZdkpZDDtz7imPEAdfRmK/kmH37LoDCpDTFYub1LVDLhQfcQiHsoFwSkjGnNg1ezIy2UbCdowGAnubUh3A0KkG3IseltMdlJ/6Yqq8uMFP9lUFqQawL7PL3ty3KM+sPNaMOV3XFi0GAV8bMrMsyO2bg6HU6CDbfhcqQftfI3RRElXpfA/lS/0xbO47txouSRX55oVPCnbowzrmM6lEn4Dz+Cjv59t1c2uE3eguzQ76Z8pDeFwsMv7a6uGL0UhKjAsjjeHf+PZoyMO89S1NZ/6TQQFT6PG1bL/Z8LlTeZ+fF7z3X/7c64zv7dvs4HjHVJYWYIOuCyBYXSe9vcSgW2edjYHld48CboqSQwIlxtLeo5r40kYsm3pIPyNOReNKllnAXDy/u9EwuN+LGz9lLVELNqq40iftueJtdKeAb7gVUeesV24FSpONswvf7ke5Kpj2XL19SY4WHSFTx8wCuWld3nhUuSIEmfJDjk0SHKL/kZY4gjjXC2h1pqO3OCTz434zKNgF8VgGlGvOFCFIllj5aT6LDbpUhp2DLILbwcOjKBw4k0/sc7XyzF8JGbzmXxgC2o4bdBKwiJGbQKDjyV4e65EEvZL+/W9mN+HGDpHVaPXd1KyTwRYfKR94MEcq5w4f8atR4iw=
  local_dir: dpl_cd_upload
  on: &3
    repo: Project-Heimdall/heimdall-webapp
    branch: development
  bucket: dev-heimdall-api-codedeploy
  region: us-west-2
  skip_cleanup: true
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: dev-heimdall-api-codedeploy
  key: $HEIMDALL_PACKAGE_NAME
  bundle_type: zip
  application: dev-heimdall-api-app
  deployment_group: dev-heimdall-api-group
  region: us-east-1
  on: *3
  skip_cleanup: true
notifications:
  slack:
    secure: UQ8y/1HLzbSakJ4YFSZE+yv57VR/Jk2Oab8bKsO36OBM92YKdmYCZqbqesKxKhFOunBmEW2oxXGcN0TmxfCwiR3j6rPTZbsjvyH1xoK1gzrJpk8VmNMIk+LOf3n+1YoScEwFHbalz3df5UNgWd4D02H8WpiVnaNJ7gb+YoxrKYke+vfRc9Q5NKOM8XjEGX4yOfDtKwPIlvDu91jBPA//SFSMZdelVN/gmo2u7MMrE7bJd/hqzG6d53voksqCZ+J+999X6KRxXeTXww0G3rkD13azVEYciTgG96boB/xCu81wHe2gamDLk4cM2IeuBKRPzcern2aB7C2EkycL9raxchs7CGxI7wKTHM4ytOiJFNf6KPy6/BlOJZl9nD85DDTNIdBH9dS48/dmZEO/MYzecSHCquWOPsiTNEIow4sicYI4VJKOj8Zk3Fvi9w3xN2hUztS5Pd0u4AE+gKwNcljj3llkU+H1BRM6h8SZxmTIdJGBOcrN1m9YNJTk7ZEsa6HsfeUjGJuAb9XStJMHNlNU3hixmTYZqsqPp91V7Swv11WM4EVCowTJoP1l0Jo7WkTTKHC9MaJhrbJzjmFE1dHkK+qFagqWPCsFX8Su0KsXUWO/+Mm1swR59bNB1FW62V5GDVulktXaE5R6dTyCPFPMIgnhzJxoNgmwYJ8Stt0il4U=
