language: node_js
node_js: 4.5.0
cache:
  directories: node_modules
env:
  global:
  - HEIMDALL_VERSION_NUMBER=1.0.0
  - HEIMDALL_PACKAGE_NAME=heimdall-api-dev-$HEIMDALL_VERSION_NUMBER.$TRAVIS_BUILD_NUMBER-$TRAVIS_BRANCH.zip
install:
- npm install -g coveralls
- npm install -g strongloop
script:
- slc build --install
before_deploy:
- zip -rq $HEIMDALL_PACKAGE_NAME *
- mkdir -p dpl_cd_upload
- mv $HEIMDALL_PACKAGE_NAME dpl_cd_upload/$HEIMDALL_PACKAGE_NAME
deploy:
- provider: s3
  access_key_id: &1
    secure: N8fxOk6r+HEpeZaAE4DmeOyEL0Zdppk+sG5I+2vAxREQICDCRJ6zn99keRBO55SB+ljkYLHGTuhc0M37MOsTkhrKePMNR+aOOTvyaQJpUixAxlXR7lGsGuwRQmwTZjhkknY6VQtah6ZRHp4Tz3Dgs9TBCfqXGONPus6X5SHPserT1M09xP4ZsZrrQ8nW5U6b366IXUyPNb7ReBcu2jsFijyHde9A9b4iSwEEiko2WyivnAM2svsd4uoPsKsGcJeXrivA5s32MopuxMO7OX2l16x4Qpd0kbxMUK3VxEMg0jVFkTv1EmzDUL/hV9nIrUjQnPVYB9fYnW17xjlutBGFoPgOyaRDwo9vVldWa8DxdAsGeJOOcznqN2549cKVWwgkhfiLLYQPBpqH3w3ZzgnR1Cl2DdvUqVmUGJJPQA6jgZK5v6cwfstxy67ei4H4p4+Q2+JTZ9zKtoD7nBCx85B3pr0nhPSh8ydrKxmYXv9Ua5IUrjv7QHPKkN1pfO6ogf3RWbh6w6uBRV+ErPkcybHwIkXPJyvunAKH6Fp1dkBobezEEngp8mn2/rPtqnPXsrWc/Rw6d0EWOybbewz3NoElDKS5PCgozJ/OE9B6z83jlSy6/+vjknaMEPRnxb7vXhLoli2Mj63o092WCBbbNsC4/UISaRx5j5oiVo5VQ3SOSMM=
  secret_access_key: &2
    secure: F5JJYnxzSd6hBMxS4uOD0WEItLxopa9j+/oVH5jnViN1IBXWoBkQe/OFHhbjDi/tzYgvB30k2a7Mm+6U40R6PJQHYoeeAx72WK6ghd8USyw34kVcfeH3iW8+9pqUKD1jX7GzcCpIOpZvF8x4jvsipikXnmxDukV9Sng7LhPd2nkeRaRcIFd8fD19NxTErbHr+P2fRpK4pWOYKNgNSo0/YKPV/YbVW/vDbFfac0iMlCoUS8rAQcLC2wfinZPMOnNpB8Kg99b/CsyFwpKzuRkY2Z++7MIzulMGdb3sXwUQ8INU1VKSRDi9GJ0Skv8ZSuYPibq05GOmFImXnpFkz51mmsGCkjoTExhi7hD6Dyq6Mp9MbUAp7+oVM746jDTRDHVwxRT/P/KJ54atZQTuJzZx2aF7j6Aen9KQ6JGV2JUPeE9WBC9fWdol5+08i8XD7eJN+QZnuP9GjE/VBoerdzXuSZORcRylBUWTIgaFc3OGYH70QMLto1SvSJ0VcRaDUfkd0iBObMfCS9gN9d99TdQZu200DHFbVF+ydybKtELr6bNshtTbrb7OTHKqIbRdjRCPf53WE3CA8XZyMve6YwF/k5YdWAKbQFb3SHAPg0N5SdrATseqoxC/Lr/fvUIUVdkpm31fNJMPEAsARZUrAWd4GhBEdC7CwH6VZDGJccfwHl8=
  local_dir: dpl_cd_upload
  on: &3
    repo: Project-Heimdall/heimdall-webapp
    branch: development
  bucket: dev-heimdall-api-codedeploy
  region: us-west-2
  skip_cleanup: true
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: dev-heimdall-api-codedeploy
  key: $HEIMDALL_PACKAGE_NAME
  bundle_type: zip
  application: dev-heimdall-api-app
  deployment_group: dev-heimdall-api-group
  region: us-east-1
  on: *3
  skip_cleanup: true
notifications:
  slack:
    secure: UQ8y/1HLzbSakJ4YFSZE+yv57VR/Jk2Oab8bKsO36OBM92YKdmYCZqbqesKxKhFOunBmEW2oxXGcN0TmxfCwiR3j6rPTZbsjvyH1xoK1gzrJpk8VmNMIk+LOf3n+1YoScEwFHbalz3df5UNgWd4D02H8WpiVnaNJ7gb+YoxrKYke+vfRc9Q5NKOM8XjEGX4yOfDtKwPIlvDu91jBPA//SFSMZdelVN/gmo2u7MMrE7bJd/hqzG6d53voksqCZ+J+999X6KRxXeTXww0G3rkD13azVEYciTgG96boB/xCu81wHe2gamDLk4cM2IeuBKRPzcern2aB7C2EkycL9raxchs7CGxI7wKTHM4ytOiJFNf6KPy6/BlOJZl9nD85DDTNIdBH9dS48/dmZEO/MYzecSHCquWOPsiTNEIow4sicYI4VJKOj8Zk3Fvi9w3xN2hUztS5Pd0u4AE+gKwNcljj3llkU+H1BRM6h8SZxmTIdJGBOcrN1m9YNJTk7ZEsa6HsfeUjGJuAb9XStJMHNlNU3hixmTYZqsqPp91V7Swv11WM4EVCowTJoP1l0Jo7WkTTKHC9MaJhrbJzjmFE1dHkK+qFagqWPCsFX8Su0KsXUWO/+Mm1swR59bNB1FW62V5GDVulktXaE5R6dTyCPFPMIgnhzJxoNgmwYJ8Stt0il4U=
