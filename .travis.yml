language: node_js
node_js: 4.5.0
cache:
  directories: node_modules
env:
  global:
  - HEIMDALL_VERSION_NUMBER=1.0.0
  - HEIMDALL_PACKAGE_NAME=heimdall-api-dev-$HEIMDALL_VERSION_NUMBER.$TRAVIS_BUILD_NUMBER-$TRAVIS_BRANCH.zip
install:
- npm install -g coveralls
- npm install -g strongloop
script:
- slc build --install
before_deploy:
- zip -rq $HEIMDALL_PACKAGE_NAME *
- mkdir -p dpl_cd_upload
- mv $HEIMDALL_PACKAGE_NAME dpl_cd_upload/$HEIMDALL_PACKAGE_NAME
deploy:
- provider: s3
  access_key_id: &1
    secure: O3Ao2Al9emvVNBYB7bb4WqKg50n4jKKD9LQtD6otzJ6AXamfK8megwFL2QgosECGH2vz75pBMlA+UaSPOMyvVX43cCDKw9D4oLPH+GKq+VqYcQTLhk7ifMUSp/dymrtGGlA9hOtzRbndIr1qgd6eeH2ana2TTAAnrnZoeyZIb+s5SaM1DvmIn9PcSrVAZliLf8d7JltesJK0eZPpFQMp3gqLxyDaDVUCj6WJmt34byPRrVihM+eDH25pVZXGAMgb4p4JTf3AHcWwzFNFTHlpi43cO+sv181Ggz3olIAtc1tOijyLUJUY5hJFxbwIUluNl3JpZCJVebBK8+J4QuqhvmJxZmq9/zwcWko3lxMprFWilqy/az0bw3R7sle0TE3l/xZRP8DmKrFv+4Q0xDd53ne6+HvfNrEg2868xly6k+wnANY2zsK0aMSFZpot14kAs3ArnSfPvk3zCmus3NQa6Rvuj1KoccjNJhoe3KzzGaVm3rOaBOlYRrje3nPVLhSPVfuHTNCkMziWnf6KEGczu789iqIhYyqVIElHq+unL1OMIJGaXzatGnYvSXByzaSHJgQuMK796Warbc7Gon6nmU38aY4za+ANh81FTODtF3xYFhykI9Zt5Eh2arYWqU/gdhkNUdOWFwVQKwS+kzXx9Tj5xldlxyOVmfO9Dj8jCvA=
  secret_access_key: &2
    secure: f7mPj6Oa+971nr06OIIFpHSZlk6R1I6Vow449ZKm0sObGroIWAkkItQ5MibwmTSA4OLp43NrKAkVbYZvJcTdGbUJMXSUmg0nHP68Q6Sxyb8sQ2xfLM/a6rByIt/2oF4ObQaHaqNEZQ62w127ANpFlITAXPPdM0B7c4DEA310lm3Z7nBu+fOUnrsGM0DEYzHwP1wFBTZy2P1ZGziTrVArJmYmLKKKPCYozeVTyQvvG02wiBFobxIxoLfbCP8Qh0g+vg9/bso2+6S0zbRJD6D3wBAHx7012qNr3YaXgaWDuNvNF0ZJdQJvA3rlAAUIDxYhJo98+yG6z3vgTaTe2kUFsvEDGJtIv29MjlkuiCl5f2cdxDagFqTrrYHcHAKo1cYLuwOkrhHcSfw6lTkTQpMAuG81YLVfl62Ng0XaQMlBKX62nTl5kJuB5IK92vKZS48goUx2lj9hv6q7IZ9wtKJsgLM/szUTf+xWubkrhNyAmEZHunQboA43NGaJctv6vwJX+cIVmxLctoJFp7TVqq4qlLRSwqjdR2/GpXfheYhPLb0olgLYVgFsqF24FSJCly1ezgMWsW7n0o3u2VAIMm/VFtvsG6XVfgb2gOokr04uePdr1Y6E5NowXXMthxu2AOK5uyObdUopdQinocILDNo2CDmBRgghpF2WNseDdLW5tFA=
  local_dir: dpl_cd_upload
  on: &3
    repo: Project-Heimdall/heimdall-webapp
    branch: development
  bucket: dev-heimdall-api-codedeploy
  region: us-west-2
  skip_cleanup: true
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: dev-heimdall-api-codedeploy
  key: $HEIMDALL_PACKAGE_NAME
  bundle_type: zip
  application: dev-heimdall-api-app
  deployment_group: dev-heimdall-api-group
  region: us-east-1
  on: *3
  skip_cleanup: true
notifications:
  slack:
    secure: UQ8y/1HLzbSakJ4YFSZE+yv57VR/Jk2Oab8bKsO36OBM92YKdmYCZqbqesKxKhFOunBmEW2oxXGcN0TmxfCwiR3j6rPTZbsjvyH1xoK1gzrJpk8VmNMIk+LOf3n+1YoScEwFHbalz3df5UNgWd4D02H8WpiVnaNJ7gb+YoxrKYke+vfRc9Q5NKOM8XjEGX4yOfDtKwPIlvDu91jBPA//SFSMZdelVN/gmo2u7MMrE7bJd/hqzG6d53voksqCZ+J+999X6KRxXeTXww0G3rkD13azVEYciTgG96boB/xCu81wHe2gamDLk4cM2IeuBKRPzcern2aB7C2EkycL9raxchs7CGxI7wKTHM4ytOiJFNf6KPy6/BlOJZl9nD85DDTNIdBH9dS48/dmZEO/MYzecSHCquWOPsiTNEIow4sicYI4VJKOj8Zk3Fvi9w3xN2hUztS5Pd0u4AE+gKwNcljj3llkU+H1BRM6h8SZxmTIdJGBOcrN1m9YNJTk7ZEsa6HsfeUjGJuAb9XStJMHNlNU3hixmTYZqsqPp91V7Swv11WM4EVCowTJoP1l0Jo7WkTTKHC9MaJhrbJzjmFE1dHkK+qFagqWPCsFX8Su0KsXUWO/+Mm1swR59bNB1FW62V5GDVulktXaE5R6dTyCPFPMIgnhzJxoNgmwYJ8Stt0il4U=
