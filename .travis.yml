language: node_js
node_js: 4.5.0
cache:
  directories: node_modules
env:
  global:
  - HEIMDALL_VERSION_NUMBER=1.0.0
  - HEIMDALL_PACKAGE_NAME=heimdall-api-dev-$HEIMDALL_VERSION_NUMBER.$TRAVIS_BUILD_NUMBER-$TRAVIS_BRANCH.zip
install:
- npm install -g coveralls
- npm install -g strongloop
script:
- slc build --install
before_deploy:
- zip -rq $HEIMDALL_PACKAGE_NAME *
- mkdir -p dpl_cd_upload
- mv $HEIMDALL_PACKAGE_NAME dpl_cd_upload/$HEIMDALL_PACKAGE_NAME
deploy:
- provider: s3
  access_key_id: &1
    secure: CGsmJdc1Hj1GPoK8+StKZoqNFmA12z4ZpG5eIb7DHrk+7eQodXa1niy+X+25kA973EU41GaApLDihePg4QtUUm6huNHSUuopez+YGh646/tmMXemw+aTUCy8Y5k2m1Yh1eCD7jG0cLLCkalIDD5Upvhx3zUUhI+eKsjivEB7wDNSxMRbtqhhHbCkUyIfd5H16MnUqirpRbQLDBjopmdvn8c29lToM5Xm7PkxbCb80Ov+/qET03Yix0LYu261slDjNlSEW90BPNvEPEPwEmWI9Q5oCEDIYR6agXYrrkMFLUtjKCq8yKUF2OgF9C65vRSYg3SxLj5AniZAFEQIRKF3kPhDW6f64mo4gwhF1WAdJljJgC+Qbs8vHO/U90qb/rCKeogD1rwggCEnwglNpIoHlCwLdvicH7HI1BMvUu10hYAJDdda8XUwK9u6E4aVwpJ3WrqvCVVOe5XpHLmdJYu1gN/+blqrVZ+nQj9On3bSx6l7Lg6nd55q9KlNEZHC+HfjvZZGmCMQVaDPqnomE+oHgXEika8V6aniV2sb6qUt74SdODh7cXIPf7r3IjzQfwvp/Kh4WuKLbEuxXxvZxgcRSfsJ7qpCrnTNQVizTOKd5QRn1fd3X1hhsekqx0l4Xoe4AOSVEwWkY1NUs/Wk4sXCOixAQaBiRFCFahxKyxY9zco=
  secret_access_key: &2
    secure: YXbYjvCeyK+3N96kf9n8UXDNxzlMEdJOQaR7wwTIIXMVZLiBl25LtCrutzJ5GdYb4+mIIv2ar4df5MUtbFo0vmJFQgP/RBufpT5pK4AwiJvU01RvXZb3hzryWf7jZ21nloEoGUtdtmueVvTKVOQkkPavqfd1boku1ucH+iYhRry7x5dX3/aO/kIvJUaCUMGRfNacd2HWB+IFtyrp1HVlsA5c9wVKWoVvbBs9NWOe6sAhJfsDUjB7VECQ4Ik6OLhJM83e+/eE3XYPWM36xAQiWNAqLa0IjQdriHq0yNuTjhwlEqlol1fkxcLdCKOgZpXn9UdU62ztZm5iwOYGxqaDrt+Mb0cZDQoNRibglxj7x5HnHiflio1LvDyAJ4Q3HSq2duGMMiw/CMfEz88SmE/bKcwHuje8rTfF1LugVtSOOV5kTr0Hn7cHF4RmKlAgqs1/2VoAKDp7DXS3t61H6AJrPSzGml3xIuos3EIdH6IMC3C7XSznS5QUHGDZZi3PHxRR7e9TKsSmHkk1a8x5gaaDbp6gpB+ECbLiPBkAZWzITzVEehR+gaECToEnvrh+sHj2/fwf6aF6CvMJS9u4j1xjG8Ilj5A98tluCeLHSHwEow1ilTr8ZV3dg+n+6uIWOqaed5APz8oRkM4t1g8KtIMH5ApnO3hix/RRklqJ6HKZCCA=
  local_dir: dpl_cd_upload
  on: &3
    repo: Project-Heimdall/heimdall-webapp
    branch: development
  bucket: dev-heimdall-api-codedeploy
  region: us-west-2
  skip_cleanup: true
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: dev-heimdall-api-codedeploy
  key: $HEIMDALL_PACKAGE_NAME
  bundle_type: zip
  application: dev-heimdall-api-app
  deployment_group: dev-heimdall-api-group
  region: us-east-1
  on: *3
  skip_cleanup: true
notifications:
  slack:
    secure: UQ8y/1HLzbSakJ4YFSZE+yv57VR/Jk2Oab8bKsO36OBM92YKdmYCZqbqesKxKhFOunBmEW2oxXGcN0TmxfCwiR3j6rPTZbsjvyH1xoK1gzrJpk8VmNMIk+LOf3n+1YoScEwFHbalz3df5UNgWd4D02H8WpiVnaNJ7gb+YoxrKYke+vfRc9Q5NKOM8XjEGX4yOfDtKwPIlvDu91jBPA//SFSMZdelVN/gmo2u7MMrE7bJd/hqzG6d53voksqCZ+J+999X6KRxXeTXww0G3rkD13azVEYciTgG96boB/xCu81wHe2gamDLk4cM2IeuBKRPzcern2aB7C2EkycL9raxchs7CGxI7wKTHM4ytOiJFNf6KPy6/BlOJZl9nD85DDTNIdBH9dS48/dmZEO/MYzecSHCquWOPsiTNEIow4sicYI4VJKOj8Zk3Fvi9w3xN2hUztS5Pd0u4AE+gKwNcljj3llkU+H1BRM6h8SZxmTIdJGBOcrN1m9YNJTk7ZEsa6HsfeUjGJuAb9XStJMHNlNU3hixmTYZqsqPp91V7Swv11WM4EVCowTJoP1l0Jo7WkTTKHC9MaJhrbJzjmFE1dHkK+qFagqWPCsFX8Su0KsXUWO/+Mm1swR59bNB1FW62V5GDVulktXaE5R6dTyCPFPMIgnhzJxoNgmwYJ8Stt0il4U=
