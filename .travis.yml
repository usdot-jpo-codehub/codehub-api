language: node_js
node_js: 4.5.0
cache:
  directories: node_modules
env:
  global:
  - HEIMDALL_VERSION_NUMBER=1.0.0
  - HEIMDALL_PACKAGE_NAME=heimdall-api-prod-$HEIMDALL_VERSION_NUMBER.$TRAVIS_BUILD_NUMBER-$TRAVIS_BRANCH.zip
install:
- npm install -g coveralls
- npm install -g strongloop
script:
- slc build --install
before_deploy:
- zip -rq $HEIMDALL_PACKAGE_NAME *
- mkdir -p dpl_cd_upload
- mv $HEIMDALL_PACKAGE_NAME dpl_cd_upload/$HEIMDALL_PACKAGE_NAME
deploy:
- provider: s3
  access_key_id: &1
    secure: wPRgCBkxzIk68nkR7+ZCiHBS9h9QgdvPH+60Q1cyVXZCGULkRVZEudWQGOaHnZT+wfvc7oidxzAzW6mstIxuf2Jr/m/Ap6gA6qDCzpctYJO9FCfsdcUJmwSna/FBpwas4bQ3OQO6K7yP3vdQKRlC/N6R55UYCCvkOr+4mysd3p5uwxNScK5cz3OA493kt5bl4dw9aBUu/IIl7ifWc6cjYgRX+VPIDih0D8i9kgMONjZYvHr3H9pfsWZpRkoRN6IATga3tnyIgnDFvQ7zeePZgrWZgEaBwxev10idFN3njevGMK2Hbak8inNjsfZ5gux3B4+7Ri9hjWKy1PB+hJo0XWBHyOUjel1y2yTjqDASFxXbHUyqx8mBHrMdGJfZWW04e1VlFSFgsjLlj91Do5cVv8gv5RLHZW1JvtXngkr47oWxnrN3Kdfq0S0zzjgUYbx+p0UTwT9T0NXVNasUO1Efhd1j3+AAuY9cu1whX6AMthWYHEns5uPdzdzC3+iVpqkjmV0NPOhYbai/jupgggi6ksRMAwT+fq0FhJd7VrA8V6cGt+h9fkL2zIM1b7noiNjU4I8fBWL2m+0B3k9HeJT/RxqxLxxyZTWbFANZhxJm4M4i8KLLVm0uG5SZYbWo3mk7B/225jVR+XveqKkKZcabDxyr9DNrCZEm5bP852QyLrc=
  secret_access_key: &2
    secure: mZ/qFNSfBkiDbLnHhJzxkIKE5GkNHkscNJOuU+bTRLBULas9Gdu3pykkJ+lf6UYeGhnN83BG27FSWyQttPC6MNnXEbmMa5PQf/mRt0GG3VexSQxb1J1vbN2hLiBrwbKerR4PQRnmZ/DNQpROo0p+ApBoUl8Tljo42UfYUCeNe59K6aRMeWzqUJ+hczvqK4ZxzDRgTa6PeWgCMlPuuYBsSvPabD4pi4ZHEXU4tltHOBS5NfEtFWFHRuT8LK0BvRViSdNREfj+B5RC28yq973mIdiMKaTCdNf+eUGYKE2YuhifwOpESui1HwCKgwWgB/VC+LzeV/FsPntrnfWbPrlrbs+lEJomBu+Sz17MS/4eZlG2g3m8MUh+BWz68dyibMKLJ7FVZitFNRArUwNfqflkshiZk4a7ctVy+ND3itfEvySbbxMEMTq3NAnLIcAHwoFkKnCezsxMtwTZzE3P96ve4c5VbH03COAYs1XZ9TtoCsnhfeVyjmxyL7+6mpPEzFTyIsYYrJ7fbdRtvIfMe7DBvgKXVxpmXNQqG5r+HqOfAlwt21Jtikf2LYlwPPPQora3wL7MHbIaBwe9HQ1yQE9Fvt9T7vVcFGew5T+aRosHV9720Q0DlpM3/+tFg8ogKvJEf1SUjkum70J7eDZKhL4qSdNeCBNc88Km+muMrpWvKJI=
  local_dir: dpl_cd_upload
  on: &3
    repo: Project-Heimdall/heimdall-webapp
    branch: master
  bucket: prod-heimdall-api-codedeploy
  region: us-west-2
  skip_cleanup: true
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: prod-heimdall-api-codedeploy
  key: $HEIMDALL_PACKAGE_NAME
  bundle_type: zip
  application: prod-heimdall-api-app
  deployment_group: prod-heimdall-api-group
  region: us-east-1
  on: *3
  skip_cleanup: true
notifications:
  slack:
    secure: UQ8y/1HLzbSakJ4YFSZE+yv57VR/Jk2Oab8bKsO36OBM92YKdmYCZqbqesKxKhFOunBmEW2oxXGcN0TmxfCwiR3j6rPTZbsjvyH1xoK1gzrJpk8VmNMIk+LOf3n+1YoScEwFHbalz3df5UNgWd4D02H8WpiVnaNJ7gb+YoxrKYke+vfRc9Q5NKOM8XjEGX4yOfDtKwPIlvDu91jBPA//SFSMZdelVN/gmo2u7MMrE7bJd/hqzG6d53voksqCZ+J+999X6KRxXeTXww0G3rkD13azVEYciTgG96boB/xCu81wHe2gamDLk4cM2IeuBKRPzcern2aB7C2EkycL9raxchs7CGxI7wKTHM4ytOiJFNf6KPy6/BlOJZl9nD85DDTNIdBH9dS48/dmZEO/MYzecSHCquWOPsiTNEIow4sicYI4VJKOj8Zk3Fvi9w3xN2hUztS5Pd0u4AE+gKwNcljj3llkU+H1BRM6h8SZxmTIdJGBOcrN1m9YNJTk7ZEsa6HsfeUjGJuAb9XStJMHNlNU3hixmTYZqsqPp91V7Swv11WM4EVCowTJoP1l0Jo7WkTTKHC9MaJhrbJzjmFE1dHkK+qFagqWPCsFX8Su0KsXUWO/+Mm1swR59bNB1FW62V5GDVulktXaE5R6dTyCPFPMIgnhzJxoNgmwYJ8Stt0il4U=
