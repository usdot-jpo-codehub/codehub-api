language: node_js
node_js: 4.5.0
cache:
  directories: node_modules
env:
  global:
  - HEIMDALL_VERSION_NUMBER=1.0.0
  - HEIMDALL_PACKAGE_NAME=heimdall-api-dev-$HEIMDALL_VERSION_NUMBER.$TRAVIS_BUILD_NUMBER-$TRAVIS_BRANCH.zip
install:
- npm install -g coveralls
- npm install -g strongloop
script:
- slc build --install
before_deploy:
- zip -rq $HEIMDALL_PACKAGE_NAME *
- mkdir -p dpl_cd_upload
- mv $HEIMDALL_PACKAGE_NAME dpl_cd_upload/$HEIMDALL_PACKAGE_NAME
deploy:
- provider: s3
  access_key_id: &1
    secure: Ayr7dczPnaGe4R/bRde7p3C0d6dgXkeP2JptUAEvs9WqluhSlmSuNYaoYlhTWq0utpkx0uS3PNdEpCIn+8GvP/o7rgehUaNzuQUvAxedQmbgGlHdm82j4Ug8ugiC+2ZjrqiYy31nrAUq5GmNe2LfHrxancqB4Wpi9JmJnmkv6Nm89YedFxsv1s+UX4RoPnRx2/dJ7oa6sLccrQ/XmebkzwB7lymo/ka+HGt2HA1JGdWyZE823jVxUGNxzKDXtvS3ASwIl3vMM/tm/ZlQRR1lwfstJP5HyzIm17+tuc3oNOjl0DC1/XLpefVZ2hvXbOBQvFh3aQOphhjd7wBnoplADezUZceYYHKbVgWayc61GXM8h40eyUjFSimJXJJ9GsC5znQd5Qh1JIpNDi64fDVMYtB1WWq1MliQX4jisiqLkRn/Si+m968z+gYIzthzYC6X5Bh8vZM8fJ+IXVUssMJzOZvthqCtoZz8AV6bb//GRlH7NyMxZ4jr7G6Fn0Hnad3ZYvTl3NN22ty0Q08ZgMx/kS7QWSuXA5U72h5N+a4+gSwJQQ190uAVtIwlqlH+zfT4k58kVfKm0lMp70shJ7ICxThDqfK+WZkrYL4ThGVO1pU4uBZ/m/ZDuJQnGCnjI4gr7XNblta/ml6AuFwnxqZ3VRlrN+3tyhl531ZjMoLbKck=
  secret_access_key: &2
    secure: aDsLCdW7bxVVk6J7/UiyFE2pJB0bh43i9ij+4yRXYKj3IQ9xtj7sRy0luP2zqwMSDM95UxkilDl9609T6AmjoqMVERw0C8yALA9JaP3KutITi5Cb31WummFWXLS9/VMxdjRZf+XGDf5ctRuPWA1Pcq/Ix92YKEMbUZb4S9VpiMLkkHU95Lptli3svnUnAn2vQqM+f3n2+t4dyjvVgPocwZVua2Y23Aoe7CoJBRDPe+FaTVkVuaEiGkl1QHXYzrFldWvTn6VVpZW8+z3lm5y03xwZTXoYMPN30fJsOqDhfN6mebWJZMSCtmjdmNL76TNdKp4wOhZTQKQRw10m/v2YKCbTIUZac5iI796rPcsEi1UgO8SknqXS7Uy1LyiuPX3V2xy8LWnW6naxhV2w+v5gxTP+NsNCRESPzkTyyBAOtFy5OkZ0EsscVg6dvleU4eQm1XZVsFuDlYjrs68BPUwvB2pru3u3xpUiaYuZHFS1I7yeA39SBsGT8ubgMB7bo7fkB5PYFKSxvQrTNUAcgH8Lct6JDXS5AppxahZTEkmw+Rek3EFmAt26aB3CkYgUS9owFuq/TfxE74HfzdrTbOoKcCDY9fJkwnvvcUQFlUOZounuAwsJcPMhoryyG7fAqiN5WztqLJ8gKUlrfDz4fehIvP1slgZDtmcbcF3fCQ4GW5A=
  local_dir: dpl_cd_upload
  on: &3
    repo: Project-Heimdall/heimdall-webapp
    branch: development
  bucket: dev-heimdall-api-codedeploy
  region: us-west-2
  skip_cleanup: true
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: dev-heimdall-api-codedeploy
  key: $HEIMDALL_PACKAGE_NAME
  bundle_type: zip
  application: dev-heimdall-api-app
  deployment_group: dev-heimdall-api-group
  region: us-east-1
  on: *3
  skip_cleanup: true
notifications:
  slack:
    secure: UQ8y/1HLzbSakJ4YFSZE+yv57VR/Jk2Oab8bKsO36OBM92YKdmYCZqbqesKxKhFOunBmEW2oxXGcN0TmxfCwiR3j6rPTZbsjvyH1xoK1gzrJpk8VmNMIk+LOf3n+1YoScEwFHbalz3df5UNgWd4D02H8WpiVnaNJ7gb+YoxrKYke+vfRc9Q5NKOM8XjEGX4yOfDtKwPIlvDu91jBPA//SFSMZdelVN/gmo2u7MMrE7bJd/hqzG6d53voksqCZ+J+999X6KRxXeTXww0G3rkD13azVEYciTgG96boB/xCu81wHe2gamDLk4cM2IeuBKRPzcern2aB7C2EkycL9raxchs7CGxI7wKTHM4ytOiJFNf6KPy6/BlOJZl9nD85DDTNIdBH9dS48/dmZEO/MYzecSHCquWOPsiTNEIow4sicYI4VJKOj8Zk3Fvi9w3xN2hUztS5Pd0u4AE+gKwNcljj3llkU+H1BRM6h8SZxmTIdJGBOcrN1m9YNJTk7ZEsa6HsfeUjGJuAb9XStJMHNlNU3hixmTYZqsqPp91V7Swv11WM4EVCowTJoP1l0Jo7WkTTKHC9MaJhrbJzjmFE1dHkK+qFagqWPCsFX8Su0KsXUWO/+Mm1swR59bNB1FW62V5GDVulktXaE5R6dTyCPFPMIgnhzJxoNgmwYJ8Stt0il4U=
